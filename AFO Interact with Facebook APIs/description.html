<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=E7560C71640616C5057FAEACB58DCB00" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2f95808e-ca34-4249-88ff-44fabe33cdc0Combined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=EEE39C2D6B93379FDAF50337BE99AF8C" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Apps for Office: Interact with Facebook APIs</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Apps for Office: Interact with Facebook APIs</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Excel 2013, apps for Office
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            sites and content, social computing
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">4/23/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Apps-for-Office-Interact-440d536c">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="header"><span class="label">Summary:</span> This sample task pane app for Excel shows how to log on to Facebook from an Excel 2013 task pane, and then how to retrieve some basic user data from Facebook by using the Facebook API.</div>
<div id="mainSection">
<div id="mainBody">
<h1 class="heading">Description</h1>
<div class="section" id="sectionSection0">
<p>This sample first displays the Facebook logon screen. Once the user has logged on to their existing Facebook account, they choose
<span class="ui">Display User Info</span> to display basic public information about themselves, such as their name, gender, user ID, birthdate, and friend count.</p>
<p>The sample makes use of standard Facebook API sample code, first in an anonymous function to load the Facebook SDK APIs asynchronously, and then in the
<span><span class="keyword">window.fbAysncInit()</span></span> function, to initialize the Facebook SDK API and authorize the user. Both functions are in the Home.html file.</p>
<p>Choosing <span class="ui">Display User Info</span> executes the <span><span class="keyword">Get Friends</span></span> function, in the Home.js file. This function gets the count of user friends, and then it passes the result to the
<span><span class="keyword">DisplayUserInfo</span></span> function. <span><span class="keyword">DisplayUserInfo</span></span> gets the rest of the basic user data and displays all the data in a table in Excel, starting at the currently selected cell, by
 using the <a href="http://msdn.microsoft.com/en-us/library/fp142294(v=office.15)" >
setSelectedDataAynsc</a> method of the <a href="http://msdn.microsoft.com/en-us/library/fp142295(v=office.15)" >
Document</a> object of the JavaScript API for Office.</p>
</div>
<h1 class="heading">Prerequisites</h1>
<div class="section" id="sectionSection1">
<p>This sample requires the following:</p>
<ul>
<li>
<p>Excel 2013.</p>
</li><li>
<p>Visual Studio 2012; apps for Office project template.</p>
</li><li>
<p>Internet Explorer 9 or Internet Explorer 10.</p>
</li><li>
<p>Basic familiarity with JavaScript and HTML.</p>
</li><li>
<p>A Facebook developer account and a Facebook app ID. To get these, see the <a href="http://code.msdn.microsoft.com/Apps-for-Office-Interact-440d536c/https://developers.facebook.com/web/" >
Facebook for Web Developers</a> documentation.</p>
</li><li>
<p>The URL of the web server where you will post the HTML page that is part of this sample. This can be of the form
<em>//localhost:port_number/</em> if you are hosting the page in IIS on your development computer. Supply this URL to Facebook when you create your Facebook app.</p>
</li></ul>
</div>
<h1 class="heading">Key components</h1>
<div class="section" id="sectionSection2">
<p>The <em>Apps for Office: Interact with Facebook APIs</em> sample is created by the FBFriendFinder solution, which contains the following projects and important files:</p>
<ul>
<li>
<p>The FBFriendFinder project, including the following file:</p>
<ul>
<li>
<p>FBFriendFinder.xml manifest file</p>
</li></ul>
</li><li>
<p>The FBFriendFinderWeb project, including the following files:</p>
<ul>
<li>
<p>Home.html file</p>
</li><li>
<p>Home.js file</p>
</li></ul>
</li></ul>
</div>
<h1 class="heading">Configure the sample</h1>
<div class="section" id="sectionSection3">
<p>In the <span><span class="keyword">window.fbAysncInit()</span></span> function, in the Home.html file, replace the
<em>appID</em> placeholder with the ID of your Facebook app.</p>
</div>
<h1 class="heading">Build the sample</h1>
<div class="section" id="sectionSection4">
<p>Choose the F5 key in Visual Studio 2012 to build and deploy the app and open it in Excel 2013.</p>
</div>
<h1 class="heading">Run and test the sample</h1>
<div class="section" id="sectionSection5">
<p>&nbsp;</p>
<ol>
<li>
<p>Open the FBFriendFinder.sln file in Visual Studio 2012.</p>
</li><li>
<p>Choose the F5 key to build and deploy the app.</p>
</li><li>
<p>Enter user information in the Facebook logon dialog box.</p>
</li><li>
<p>Choose <span class="ui">Display User Info</span> in the Excel task pane to display user information in Excel.</p>
</li></ol>
</div>
<h1 class="heading">Troubleshooting</h1>
<div class="section" id="sectionSection6">
<p>If the app fails to display the Facebook logon dialog box, ensure that you are using the correct ID for the Facebook app you created. Also check that you enter the correct URL of the HTML page that is part of this sample in the Facebook App information screen.</p>
</div>
<h1 class="heading">Change log</h1>
<div class="section" id="sectionSection7">
<p>Second release.</p>
</div>
<h1 class="heading">Related content</h1>
<div class="section" id="sectionSection8">
<ul>
<li>
<p><a href="http://msdn.microsoft.com/en-us/library/fp142185(office.15).aspx" >JavaScript API for Office</a></p>
</li></ul>
</div>
</div>
</div>

</div>


    </div>
</body>
</html>

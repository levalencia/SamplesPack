@model IEnumerable<Microsoft.Office365.OutlookServices.IContact>

@{
  ViewBag.Title = "Contacts";
}

<h2>Contacts</h2>

<table class="table table-striped">
  <tr>
    <th>Given Name</th>
    <th>Surname</th>
    <th>Company</th>
    <th></th>
  </tr>

  @foreach (var item in Model) {
    <tr>
      <td>@item.GivenName</td>
      <td>@item.Surname</td>
      <td>@item.CompanyName</td>
      <td><a href="@Url.Action("ComposeMessage", "Home", new { recipient = item.EmailAddresses[0].Address })"><span class="glyphicon glyphicon-envelope"></span></a></td>
    </tr>
  }

</table>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=E7560C71640616C5057FAEACB58DCB00" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2f95808e-ca34-4249-88ff-44fabe33cdc0Combined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=EEE39C2D6B93379FDAF50337BE99AF8C" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Apps for Office: Visualizing and interacting with Excel data</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Apps for Office: Visualizing and interacting with Excel data</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Excel 2013, apps for Office
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            data and storage
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">5/8/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Apps-for-Office-Visualizing-6e1b47a6">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="header">The Office app includes a task pane app and a content app. It also includes an Excel workbook, PopulationVisualization.xlsx, that contains sample data.</div>
<div id="mainSection">
<div id="mainBody">
<div class="introduction">
<div class="section" id="sectionSection0">
<p>The PopulationVisualization.xlsx file is set as the <span><span class="keyword">StartAction</span></span> property of the app for Office. The workbook has a named cell called VisualStyle (cell B2), and a named table called PopulationTable (cells A6:B16).
 The following screen shots shows how the document and the app will appear after you start the solution.</p>
<p>Figure 1 shows the workbook opened with the content app displayed.</p>
<div class="caption">Figure 1. PopulationVisualization.xlsx showing the content app.</div>
<br>
<img id="79598" src="description/CG_XLDataVis_fig01.gif" alt="PopulationVisualization.xlsx showing the 2 apps" width="712" height="636">
<p>Figure 2 shows the task pane app UI.</p>
<div class="caption">Figure 2. The task pane app UI.</div>
<br>
<img id="79599" src="description/CG_XLDataVis_fig02.gif" alt="Binding has happened successfully" width="350" height="755">
<p>The sample shows:</p>
<ul>
<li>
<p>How to use JavaScript to add bindings to the named cell and the named table in the workbook.</p>
</li><li>
<p>How to verify that those bindings are in place before attempting to retrieve the values from them or to set their values in code.</p>
</li><li>
<p>How to set values in bindings from code, specifically in this case from the task pane app.</p>
</li><li>
<p>How to retrieve values from the named cell and named table, and to use that data to create different types of visualizations for the data.</p>
</li><li>
<p>How to respond to change events for the data bindings.</p>
</li></ul>
</div>
<h1 class="heading">Prerequisites</h1>
<div class="section" id="sectionSection1">
<p>This sample requires:</p>
<ul>
<li>
<p>Visual Studio 2012 (RTM).</p>
</li><li>
<p>Office 2013 tools for Visual Studio 2012 (RTM).</p>
</li><li>
<p>Excel 2013 (RTM).</p>
</li></ul>
</div>
<h1 class="heading">Key components of the sample</h1>
<div class="section" id="sectionSection2">
<p>The sample app contains:</p>
<ul>
<li>
<p>The ExcelDataVisualization project, which contains:</p>
<ul>
<li>
<p>The ExcelDataVisualization.xml manifest file.</p>
</li><li>
<p>The ExcelDataVisualizationTaskPane.xml manifest file.</p>
</li><li>
<p>The PopulationVisualization.xlsx document, which is prepopulated with a named cell and a named table.</p>
</li></ul>
</li><li>
<p>The ExcelDataVisualizationWeb project, which contains multiple template files. However, the four files that have been developed as part of this sample solution include:</p>
<ul>
<li>
<p>PopulationVisualizationTaskPane.html (in the Pages folder). This contains the HTML user interface that is displayed in the task pane. It consists of a &lt;div&gt; with an ID of
<span><span class="keyword">validationReport</span></span>, and two buttons.</p>
</li><li>
<p>PopulationVisualizationTaskPane.html (in the Pages folder). This contains the HTML user interface that is displayed in the task pane. It consists of a &lt;div&gt; with an ID of
<span><span class="keyword">validationReport</span></span>, and two buttons.</p>
</li><li>
<p>PopulationVisualizationContent.html (in the Pages folder). This contains the HTML user interface that is displayed in the task pane. It consists of a &lt;div&gt; with an IDof
<span><span class="keyword">chart</span></span>.</p>
</li><li>
<p>PopulationVisualizationTaskPane.js (in the Scripts folder). This script file contains code that runs when the content app is loaded. This startup script attempts to add bindings to the named cell in the workbook. The success or failure of this operation
 is reported back to the PopulationVisualizationTaskPane.html page. The script file also includes the
<span><span class="keyword">Click</span></span> event handlers for the two buttons in PopulationVisualizationTaskPane.html. One of these buttons sets the value in the binding for the named cell to 'Stacked', and the other buttons sets the value in the binding
 for the named cell to 'Tiled'. These changes will raise binding events that are handled in PopulationVisualizationContent.js (see below).</p>
</li><li>
<p>PopulationVisualizationContent.js (in the Scripts folder). This script file contains code that runs when the content app is loaded. This startup script attempts to add bindings to the named cell and named table in the workbook in the document. If the named
 cell has a value of either &quot;Stacked&quot; or &quot;Tiled&quot;, the script builds an appropriate chart based on the data in the named table. Otherwise, it writes a simple message to the chart area, informing the user to choose a style for the visualization. The script file
 also includes two handlers, one of which responds to data change events in the binding to the named cell, and the other which responds to data change events in the binding to the named table. When either of these events is raised and handled, the current data
 visualization is destroyed and then recreated.</p>
</li></ul>
</li></ul>
<p>All other files are automatically provided by the Visual Studio project template for apps for Office, and they have not been modified in the development of this sample app.</p>
</div>
<h1 class="heading">Configure the sample</h1>
<div class="section" id="sectionSection3">
<p>To configure the sample, open the ExcelDataVisualization.sln file with Visual Studio 2012. No other configuration is necessary.</p>
</div>
<h1 class="heading">Build the sample</h1>
<div class="section" id="sectionSection4">
<p>To build the sample, choose the Ctrl&#43;Shift&#43;B keys.</p>
</div>
<h1 class="heading">Run and test the sample</h1>
<div class="section" id="sectionSection5">
<p>To run the sample, choose the F5 key.</p>
<p>The following images show examples of the workbook at various stages of the process.</p>
<p>Figure 3 shows that the code has successfully created a binding to the named cell. The status of this initial binding has been reported in the task pane.</p>
<div class="caption">Figure 3. The task pane UI showing that the binding was successful.</div>
<br>
<img id="79600" src="description/CG_XLDataVis_fig03.gif" alt="View stacked populations button was chosen" width="350" height="756">
<p>The View stacked populations button calls code that takes the data in the data table and uses it to build the stacked visualization. In this case, squares representing each country's population have been overlaid on each other. When the user pauses the mouse
 pointer on a specific shade of green (representing a country), the tooltip provides the name of the country and the population value. Also note that the task pane includes a message that the visual style has been set successfully.</p>
<p>Figure 4 shows how the content pane appears when the View stacked populations button has been chosen.</p>
<div class="caption">Figure 4. The stacked populations view.</div>
<br>
<img id="79601" src="description/CG_XLDataVis_fig04.gif" alt="View tiled populations button was chosen" width="300" height="400">
<p>Alternatively, you could choose the View tiled populations. When you view the population in a tiled visualization, the task pane UI looks the same as when you choose the stacked visualization, but the content app changes to show the various populations in
 tiles. In this case, squares representing each country's population have been displayed in a jigsaw-like manner. When the user pauses the mouse pointer on a specific shade of green (representing a country), the tooltip provides the name of the country and
 the population value. Also note that the task pane includes a message that the visual style has been set successfully.</p>
<p>Figure 5 shows how the content pane appears when the View tiled populations button has been chosen.</p>
<p>Figure 5. The tiled populations view.</p>
<img id="79602" src="description/CG_XLDataVis_fig05.gif" alt="Table has been updated with new data" width="299" height="400"></div>
<h1 class="heading">Troubleshooting</h1>
<div class="section" id="sectionSection6">
<p>If the app starts with a blank document instead of the one shown in Figure 1, ensure that the
<span><span class="keyword">StartAction</span></span> property of the ExcelDataVisualization project is set to PopulationVisualization.xlsx and not just to Excel.</p>
</div>
<h1 class="heading">Change log</h1>
<div class="section" id="sectionSection7">
<p>First release: March 15, 2013.</p>
</div>
<h1 class="heading">Related content</h1>
<div class="section" id="sectionSection8">
<ul>
<li>
<p><a href="http://msdn.microsoft.com/en-us/library/jj220060.aspx" >Build apps for Office</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/fp123511.aspx" >Binding to regions in a document or spreadsheet</a></p>
</li></ul>
</div>
</div>
</div>
</div>

</div>


    </div>
</body>
</html>
